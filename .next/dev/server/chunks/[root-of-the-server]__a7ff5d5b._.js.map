{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALG/Downloads/edc-nit-durgapur-landing-page%20%282%29/lib/db.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\n\nconst FALLBACK_URI = \"mongodb+srv://SuyashGupta:<db_password>@cluster0.dgobo2d.mongodb.net/?appName=Cluster0\";\nconst MONGODB_URI = process.env.MONGODB_URI || FALLBACK_URI;\n\n\ndeclare global {\n  var mongoose: any;\n}\n\nlet cached = (globalThis as any).mongoose;\n\nif (!cached) {\n  cached = (globalThis as any).mongoose = { conn: null, promise: null };\n}\n\nasync function dbConnect() {\n  if (!MONGODB_URI) {\n    throw new Error('Please define the MONGODB_URI environment variable inside .env.local');\n  }\n\n  \n  if (MONGODB_URI.includes('<db_password>')) {\n    throw new Error('Invalid MongoDB URI: Please replace <db_password> with your actual database password in lib/db.ts');\n  }\n\n  if (cached.conn) {\n    return cached.conn;\n  }\n\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false,\n    };\n\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      return mongoose;\n    });\n  }\n  \n  try {\n    cached.conn = await cached.promise;\n  } catch (e) {\n    cached.promise = null;\n    throw e;\n  }\n\n  return cached.conn;\n}\n\nexport default dbConnect;"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,eAAe;AACrB,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAO/C,IAAI,SAAS,AAAC,WAAmB,QAAQ;AAEzC,IAAI,CAAC,QAAQ;IACX,SAAS,AAAC,WAAmB,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACtE;AAEA,eAAe;IACb;;IAKA,IAAI,YAAY,QAAQ,CAAC,kBAAkB;QACzC,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALG/Downloads/edc-nit-durgapur-landing-page%20%282%29/models/User.ts"],"sourcesContent":["import mongoose, { Schema, Document, Model } from 'mongoose';\r\n\r\nexport interface IUser extends Document {\r\n  username: string;\r\n  email: string;\r\n  mobileNumber: string;\r\n  password: string;\r\n  domain: string;\r\n  reason: string;\r\n  round: number;\r\n  hasSelection: boolean;\r\n  applicationStatus: 'active' | 'rejected';\r\n  createdAt: Date;\r\n  isAdmin:boolean;\r\n}\r\n\r\nconst UserSchema = new Schema<IUser>({\r\n  username: {\r\n    type: String,\r\n    required: [true, 'Please provide a username'],\r\n    unique: true,\r\n  },\r\n  email: {\r\n    type: String,\r\n    required: [true, 'Please provide an email'],\r\n    unique: true,\r\n  },\r\n  mobileNumber: {\r\n    type: String,\r\n    required: false, \r\n  },\r\n  password: {\r\n    type: String,\r\n    required: [true, 'Please provide a password'],\r\n  },\r\n  domain: {\r\n    type: String,\r\n    required: [true, 'Please select a domain'],\r\n  },\r\n  reason: {\r\n    type: String,\r\n    required: [true, 'Please provide a reason for joining'],\r\n    default: \"No reason provided.\", \r\n  },\r\n  round: {\r\n    type: Number,\r\n    default: 0, \r\n  },\r\n  hasSelection: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  applicationStatus: {\r\n    type: String,\r\n    enum: ['active', 'rejected'],\r\n    default: 'active',\r\n  },\r\n  createdAt: {\r\n    type: Date,\r\n    default: Date.now,\r\n  },\r\n  isAdmin: {\r\n    type:Boolean,\r\n    default:false,\r\n  },\r\n});\r\n\r\n// IMPORTANT: Delete the model if it exists to prevent caching issues with schema updates in development\r\nif (mongoose.models.User) {\r\n  delete mongoose.models.User;\r\n}\r\n\r\nconst User: Model<IUser> = mongoose.model<IUser>('User', UserSchema);\r\n\r\nexport default User;"],"names":[],"mappings":";;;;AAAA;;AAgBA,MAAM,aAAa,IAAI,mHAAM,CAAQ;IACnC,UAAU;QACR,MAAM;QACN,UAAU;YAAC;YAAM;SAA4B;QAC7C,QAAQ;IACV;IACA,OAAO;QACL,MAAM;QACN,UAAU;YAAC;YAAM;SAA0B;QAC3C,QAAQ;IACV;IACA,cAAc;QACZ,MAAM;QACN,UAAU;IACZ;IACA,UAAU;QACR,MAAM;QACN,UAAU;YAAC;YAAM;SAA4B;IAC/C;IACA,QAAQ;QACN,MAAM;QACN,UAAU;YAAC;YAAM;SAAyB;IAC5C;IACA,QAAQ;QACN,MAAM;QACN,UAAU;YAAC;YAAM;SAAsC;QACvD,SAAS;IACX;IACA,OAAO;QACL,MAAM;QACN,SAAS;IACX;IACA,cAAc;QACZ,MAAM;QACN,SAAS;IACX;IACA,mBAAmB;QACjB,MAAM;QACN,MAAM;YAAC;YAAU;SAAW;QAC5B,SAAS;IACX;IACA,WAAW;QACT,MAAM;QACN,SAAS,KAAK,GAAG;IACnB;IACA,SAAS;QACP,MAAK;QACL,SAAQ;IACV;AACF;AAEA,wGAAwG;AACxG,IAAI,oHAAQ,CAAC,MAAM,CAAC,IAAI,EAAE;IACxB,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI;AAC7B;AAEA,MAAM,OAAqB,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAE1C"}},
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALG/Downloads/edc-nit-durgapur-landing-page%20%282%29/lib/mail.ts"],"sourcesContent":["import nodemailer from 'nodemailer';\r\n\r\n\r\nconst transporter = nodemailer.createTransport({\r\n  service: 'gmail',\r\n  auth: {\r\n    user: process.env.EMAIL_USER,\r\n    pass: process.env.EMAIL_PASS,\r\n  },\r\n});\r\n\r\nexport const sendStatusEmail = async (\r\n  email: string,\r\n  username: string,\r\n  round: number,\r\n  domain: string\r\n) => {\r\n  \r\n  if (!process.env.EMAIL_USER || !process.env.EMAIL_PASS) {\r\n    console.log(`[Mock Email] To: ${email} | Subject: Round ${round} Update | User: ${username}`);\r\n    return;\r\n  }\r\n\r\n  let subject = '';\r\n  let htmlContent = '';\r\n\r\n  const commonStyle = `\r\n    font-family: sans-serif; \r\n    color: #333; \r\n    line-height: 1.6;\r\n    max-width: 600px;\r\n    margin: 0 auto;\r\n    padding: 20px;\r\n    border: 1px solid #eee;\r\n    border-radius: 8px;\r\n  `;\r\n\r\n  const header = `\r\n    <div style=\"background-color: #000; padding: 15px; text-align: center; border-radius: 8px 8px 0 0;\">\r\n        <h2 style=\"color: #ccff00; margin: 0;\">EDC Recruitment</h2>\r\n    </div>\r\n  `;\r\n\r\n  switch (round) {\r\n    case 1:\r\n      subject = 'Update: EDC Recruitment Round 1';\r\n      htmlContent = `\r\n        ${header}\r\n        <div style=\"padding: 20px;\">\r\n            <h3>Hello ${username},</h3>\r\n            <p>Congratulations! You have cleared the initial screening for the <strong>${domain}</strong> domain.</p>\r\n            <p>You have been shortlisted for <strong>Round 1</strong> (Personal Interview). Details regarding the schedule will be shared shortly.</p>\r\n            <p>Best Regards,<br/>EDC Team</p>\r\n        </div>\r\n      `;\r\n      break;\r\n    case 2:\r\n      subject = 'Update: Advanced to Round 2';\r\n      htmlContent = `\r\n        ${header}\r\n        <div style=\"padding: 20px;\">\r\n            <h3>Great Job, ${username}!</h3>\r\n            <p>We are pleased to inform you that you have successfully cleared Round 1.</p>\r\n            <p>You are now advancing to <strong>Round 2</strong> (Technical/Task Round) for the <strong>${domain}</strong> domain.</p>\r\n            <p>Keep up the momentum!</p>\r\n            <p>Best Regards,<br/>EDC Team</p>\r\n        </div>\r\n      `;\r\n      break;\r\n    case 3:\r\n      subject = 'Update: Final Interview Round';\r\n      htmlContent = `\r\n        ${header}\r\n        <div style=\"padding: 20px;\">\r\n            <h3>Almost There, ${username}!</h3>\r\n            <p>Your performance has been impressive. You have been selected for the <strong>Final Interview (Round 3)</strong>.</p>\r\n            <p>This is the last step in the recruitment process for the <strong>${domain}</strong> domain.</p>\r\n            <p>Best Regards,<br/>EDC Team</p>\r\n        </div>\r\n      `;\r\n      break;\r\n    case 4:\r\n      subject = 'Congratulations! Welcome to EDC';\r\n      htmlContent = `\r\n        ${header}\r\n        <div style=\"padding: 20px; border-left: 4px solid #ccff00;\">\r\n            <h2 style=\"color: #000;\">Welcome to the Team!</h2>\r\n            <p>Dear ${username},</p>\r\n            <p>We are thrilled to invite you to join the <strong>Entrepreneurship Development Cell</strong>.</p>\r\n            <p>You have been officially selected for the <strong>${domain}</strong> domain.</p>\r\n            <p>Get ready to innovate, ideate, and incubate!</p>\r\n            <p>Cheers,<br/>EDC NIT Durgapur</p>\r\n        </div>\r\n      `;\r\n      break;\r\n    default:\r\n      return; \r\n  }\r\n\r\n  try {\r\n    await transporter.sendMail({\r\n      from: `\"EDC Recruitment\" <${process.env.EMAIL_USER}>`,\r\n      to: email,\r\n      subject: subject,\r\n      html: `<div style=\"${commonStyle}\">${htmlContent}</div>`,\r\n    });\r\n    console.log(`Email sent to ${email} for Round ${round}`);\r\n  } catch (error) {\r\n    console.error('Error sending email:', error);\r\n    \r\n  }\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;IAC7C,SAAS;IACT,MAAM;QACJ,MAAM,QAAQ,GAAG,CAAC,UAAU;QAC5B,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC9B;AACF;AAEO,MAAM,kBAAkB,OAC7B,OACA,UACA,OACA;IAGA,IAAI,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI,CAAC,QAAQ,GAAG,CAAC,UAAU,EAAE;QACtD,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,MAAM,kBAAkB,EAAE,MAAM,gBAAgB,EAAE,UAAU;QAC5F;IACF;IAEA,IAAI,UAAU;IACd,IAAI,cAAc;IAElB,MAAM,cAAc,CAAC;;;;;;;;;EASrB,CAAC;IAED,MAAM,SAAS,CAAC;;;;EAIhB,CAAC;IAED,OAAQ;QACN,KAAK;YACH,UAAU;YACV,cAAc,CAAC;QACb,EAAE,OAAO;;sBAEK,EAAE,SAAS;uFACsD,EAAE,OAAO;;;;MAI1F,CAAC;YACD;QACF,KAAK;YACH,UAAU;YACV,cAAc,CAAC;QACb,EAAE,OAAO;;2BAEU,EAAE,SAAS;;wGAEkE,EAAE,OAAO;;;;MAI3G,CAAC;YACD;QACF,KAAK;YACH,UAAU;YACV,cAAc,CAAC;QACb,EAAE,OAAO;;8BAEa,EAAE,SAAS;;gFAEuC,EAAE,OAAO;;;MAGnF,CAAC;YACD;QACF,KAAK;YACH,UAAU;YACV,cAAc,CAAC;QACb,EAAE,OAAO;;;oBAGG,EAAE,SAAS;;iEAEkC,EAAE,OAAO;;;;MAIpE,CAAC;YACD;QACF;YACE;IACJ;IAEA,IAAI;QACF,MAAM,YAAY,QAAQ,CAAC;YACzB,MAAM,CAAC,mBAAmB,EAAE,QAAQ,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YACrD,IAAI;YACJ,SAAS;YACT,MAAM,CAAC,YAAY,EAAE,YAAY,EAAE,EAAE,YAAY,MAAM,CAAC;QAC1D;QACA,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,MAAM,WAAW,EAAE,OAAO;IACzD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;IAExC;AACF"}},
    {"offset": {"line": 377, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALG/Downloads/edc-nit-durgapur-landing-page%20%282%29/app/api/admin/update/route.ts"],"sourcesContent":["import dbConnect from '@/lib/db';\nimport User from '@/models/User';\nimport { NextResponse } from 'next/server';\nimport { sendStatusEmail } from '@/lib/mail';\n\nconst ADMIN_KEY = \"EDC_ADMIN_2024\";\n\nexport async function POST(req: Request) {\n  await dbConnect();\n\n  const apiKey = req.headers.get('admin-key');\n\n  if (apiKey !== ADMIN_KEY) {\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n  }\n\n  try {\n    const body = await req.json();\n    const { userId, round, applicationStatus } = body;\n\n    if (!userId) {\n      return NextResponse.json({ error: 'Invalid data' }, { status: 400 });\n    }\n\n    const currentUser = await User.findById(userId);\n    if (!currentUser) {\n        return NextResponse.json({ error: 'User not found' }, { status: 404 });\n    }\n\n    const updates: any = {};\n    \n    \n    if (typeof round === 'number') {\n        updates.round = round;\n        updates.hasSelection = round >= 4;\n    }\n\n    \n    if (applicationStatus) {\n        updates.applicationStatus = applicationStatus;\n    }\n\n    \n    const updatedUser = await User.findByIdAndUpdate(\n      userId,\n      updates,\n      { new: true }\n    );\n\n    \n    \n    if (typeof round === 'number' && round > currentUser.round && updatedUser.applicationStatus === 'active') {\n        console.log(`[Email Trigger] Promoting ${updatedUser.username} to Round ${round}`);\n        try {\n            await sendStatusEmail(\n                updatedUser.email, \n                updatedUser.username, \n                round, \n                updatedUser.domain\n            );\n        } catch (emailError) {\n            console.error(\"[Email Failure]\", emailError);\n        }\n    }\n\n    return NextResponse.json({ success: true, user: updatedUser });\n  } catch (error: any) {\n    return NextResponse.json({ error: error.message }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,YAAY;AAEX,eAAe,KAAK,GAAY;IACrC,MAAM,IAAA,sHAAS;IAEf,MAAM,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC;IAE/B,IAAI,WAAW,WAAW;QACxB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;IAEA,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,iBAAiB,EAAE,GAAG;QAE7C,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,MAAM,cAAc,MAAM,2HAAI,CAAC,QAAQ,CAAC;QACxC,IAAI,CAAC,aAAa;YACd,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,UAAe,CAAC;QAGtB,IAAI,OAAO,UAAU,UAAU;YAC3B,QAAQ,KAAK,GAAG;YAChB,QAAQ,YAAY,GAAG,SAAS;QACpC;QAGA,IAAI,mBAAmB;YACnB,QAAQ,iBAAiB,GAAG;QAChC;QAGA,MAAM,cAAc,MAAM,2HAAI,CAAC,iBAAiB,CAC9C,QACA,SACA;YAAE,KAAK;QAAK;QAKd,IAAI,OAAO,UAAU,YAAY,QAAQ,YAAY,KAAK,IAAI,YAAY,iBAAiB,KAAK,UAAU;YACtG,QAAQ,GAAG,CAAC,CAAC,0BAA0B,EAAE,YAAY,QAAQ,CAAC,UAAU,EAAE,OAAO;YACjF,IAAI;gBACA,MAAM,IAAA,gIAAe,EACjB,YAAY,KAAK,EACjB,YAAY,QAAQ,EACpB,OACA,YAAY,MAAM;YAE1B,EAAE,OAAO,YAAY;gBACjB,QAAQ,KAAK,CAAC,mBAAmB;YACrC;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAY;IAC9D,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACF"}}]
}